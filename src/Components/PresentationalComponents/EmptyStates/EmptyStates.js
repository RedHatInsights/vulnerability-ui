import React from 'react';
import propTypes from 'prop-types';
import { FormattedMessage } from 'react-intl';
import {
    Bullseye,
    Button,
    EmptyStateVariant,
    EmptyState,
    EmptyStateBody,
    EmptyStateIcon,
    Text,
    TextContent,
    Title,
    Alert
} from '@patternfly/react-core';
import { ExternalLinkAltIcon, SecurityIcon } from '@patternfly/react-icons';
import messages from '../../../Messages';
import { NotAuthorized as FECNotAuthorized } from '@redhat-cloud-services/frontend-components/NotAuthorized';
import { LockIcon } from '@patternfly/react-icons';
import { intl } from '../../../Utilities/IntlProvider';
import PropTypes from 'prop-types';

export const EmptyStateNoCVEs = ({ secondParagraph, showHighVisibilityCveAlert }) => (
    <EmptyState variant={EmptyStateVariant.large}>
        <Title headingLevel="h5" size="lg">
            <FormattedMessage {...messages.emptyStateNoMatchingCves} />
        </Title>
        <TextContent>
            <EmptyStateBody>
                <Text>
                    <FormattedMessage {...messages.emptyStateEditFilterSettings} />
                </Text>
                <Text>
                    <FormattedMessage {...secondParagraph} values={{ link: (
                        <a href="https://access.redhat.com/security/team/contact/" target="__blank" rel="noopener noreferrer">
                            <FormattedMessage {...messages.emptyStateProdSecLink} />  <ExternalLinkAltIcon />
                        </a>
                    ) }} />
                </Text>
                {showHighVisibilityCveAlert && <Alert
                    className="high-visibility-cve pf-u-mt-lg"
                    variant="warning"
                    isInline
                    title={intl.formatMessage(messages.highVisibilityCveBody,
                        { synopsis: 'CVE-2021-44228', celebrityName: 'Apache Log4j' })
                    }
                    actionLinks={
                        <a
                            href="https://access.redhat.com/security/cve/CVE-2021-44228"
                            target="__blank"
                            rel="noopener noreferrer"
                        >
                            {intl.formatMessage(messages.highVisibilityCveLink, { synopsis: 'CVE-2021-44228' })}
                            <ExternalLinkAltIcon className="pf-u-ml-xs"/>
                        </a>
                    }/>}
            </EmptyStateBody>
        </TextContent>
    </EmptyState>
);

EmptyStateNoCVEs.propTypes = {
    secondParagraph: PropTypes.object,
    showHighVisibilityCveAlert: PropTypes.bool
};

export const EmptyStateNoSystems = () => (
    <EmptyState variant={EmptyStateVariant.large}>
        <Title headingLevel="h5" size="lg">
            <FormattedMessage {...messages.emptyStateNoMatchingSystems} />
        </Title>
        <TextContent>
            <EmptyStateBody>
                <Text>
                    <FormattedMessage {...messages.emptyStateEditFilterSettings} />
                </Text>
            </EmptyStateBody>
        </TextContent>
    </EmptyState>
);

export const EmptyStateExcludedSystem = ({ buttonAction }) => (
    <Bullseye>
        <EmptyState variant={EmptyStateVariant.large}>
            <EmptyStateIcon icon={SecurityIcon} size="sm" />
            <Title headingLevel="h5" size="lg">
                <FormattedMessage {...messages.emptyStateSystemExcludedTitle} />
            </Title>
            <EmptyStateBody>
                <FormattedMessage {...messages.emptyStateSystemExcludedBody} />
            </EmptyStateBody>
            <Button variant="primary" component="a" onClick={buttonAction}>
                <FormattedMessage {...messages.emptyStateSystemResumeAnalysis} />
            </Button>
        </EmptyState>
    </Bullseye>
);

EmptyStateExcludedSystem.propTypes = {
    buttonAction: propTypes.func
};

export const NotAuthorized = ({ title }) => (
    <FECNotAuthorized
        icon={LockIcon}
        title={title ?? intl.formatMessage(messages.notAuthorizedTitle)}
        description={intl.formatMessage(messages.notAuthorizedDescription)}
        prevPageButtonText={intl.formatMessage(messages.returnToPreviousPage)}
        toLandingPageText={intl.formatMessage(messages.returnToLandingPage)}
    />
);

export const NoDescriptionAvailable = () => (
    <Bullseye>
        <EmptyState variant={EmptyStateVariant.large} className="no-description-available" style={{ padding: 0 }}>
            <Text>
                <FormattedMessage {...messages.noDescription} />
            </Text>
            <EmptyStateBody>
                <FormattedMessage {...messages.noMetadataDescription} />
            </EmptyStateBody>
        </EmptyState>
    </Bullseye>
);

NotAuthorized.propTypes = {
    title: propTypes.string
};
