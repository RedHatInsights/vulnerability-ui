import toJson from 'enzyme-to-json';
import React from 'react';
import CVEPageDetailsSeverity from './CVEPageDetailsSeverity';
import { mountWithIntl } from '../../../Helpers/MiscHelper';

const cveAttributes = {
    business_risk: "Low",
    business_risk_id: 1,
    business_risk_justification: "m",
    cvss2_metrics: null,
    cvss2_score: null,
    cvss3_metrics: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    cvss3_score: "7.800",
    description: "A flaw was found in sudo. A heap-based buffer overflow was found in the way sudo parses command line arguments. This flaw is exploitable by any local user who can execute the sudo command (by default, any local user can execute sudo) without authentication. Successful exploitation of this flaw could lead to privilege escalation. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.",
    impact: "Important",
    public_date: "26 Jan 2021",
    status: "Resolved",
    status_id: 4,
    status_justification: null,
    synopsis: "CVE-2021-3156",
    systems_status_divergent: 206,
    systems_status_detail: {
        0: 114,
        4: 4
    }
}

describe('CVEPageDetailsSeverity component', () => {
    it('should render correctly', () => {
        const wrapper = mountWithIntl(<CVEPageDetailsSeverity cveAttributes={cveAttributes} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });
});
