import { compareVersions } from '../../../../Helpers/MiscHelper';

const buildOSGroups = (osVersions = []) => {
    let groups = osVersions.reduce((acc, version) => {
        const { major, minor } = version;
        const groupName = `RHEL ${major}`;

        acc[groupName] = [
            ...(acc[groupName] || []),
            {
                label: `RHEL ${major}.${minor}`,
                value: `${major}.${minor}`
            }
        ];

        return acc;
    }, {});

    // sort by group, desc
    groups = Object.entries(groups);
    groups.sort((a, b) => compareVersions(a[0], b[0], false));

    // sort versions, desc
    groups = groups.map(([groupName, versions]) => [
        groupName,
        Array.from(versions).sort((a, b) =>
            compareVersions(a.value, b.value, false)
        )
    ]);

    return Object.fromEntries(groups);
};

export default buildOSGroups;
