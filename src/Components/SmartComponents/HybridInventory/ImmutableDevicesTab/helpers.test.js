import { useOnLoad } from "./helpers";
import { renderHook } from '@testing-library/react-hooks';

jest.mock('../../../../Utilities/ReducerRegistry', () => ({
    __esModule: true,
    ...jest.requireActual('../../../../Utilities/ReducerRegistry'),
    default: { register: jest.fn(() => {}) }
}));

jest.mock('../../../../Store/Reducers/InventoryEntitiesReducer', () => ({
    ...jest.requireActual('../../../../Store/Reducers/InventoryEntitiesReducer'),
    inventoryEntitiesReducer: jest.fn(() => ['test-reducers'])
}));

const parameters = { sort: '-inventory_group'}
const mergeWithEntities = jest.fn();

describe('useOnLoad', () => {
    it('Should change "inventory_group" sort key to "group_name" from parameters.', () => {
        const { result } = renderHook(() => useOnLoad(parameters));

        result.current({ mergeWithEntities });
    
        expect(mergeWithEntities).toHaveBeenCalledWith(
            ['test-reducers'], 
            {
                page: 1, 
                perPage: 20, 
                sortBy: {
                    direction: "desc",
                    key: "group_name",
                },
            }
        );
    });
});