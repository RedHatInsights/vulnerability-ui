import React, { Fragment } from 'react';
import PropTypes from 'prop-types';
import Label from '../Snippets/Label';
import { Link } from 'react-router-dom';
import { VolumeIcon } from '@patternfly/react-icons';
import { Text, TextContent, TextVariants, Tooltip } from '@patternfly/react-core';

const CVETableExpandedCell = ({ description, rules, cve }) => {
    const ruleIconTooltip = 'Denotes a security rule. Security rules are written by Red Hat to help you configure your systems';
    return (
        <TextContent>
            <Label>Description</Label>
            <Text component={TextVariants.p}>{description}</Text>

            {rules && rules.map((rule, i) => (
                <Fragment key={i}>
                    <Text className={'icon-with-label'} component={TextVariants.p}>
                        <Label className={'icon-with-label'}>
                            <Tooltip content={ruleIconTooltip}>
                                <VolumeIcon />
                            </Tooltip>
                            {rule.rule_id}
                        </Label>
                    </Text>
                    <Text component={TextVariants.p}>
                        {rule.description}

                    </Text>
                    <Text component={TextVariants.p}>
                        <Link to={`/cves/${cve}`}>Read more</Link>
                    </Text>

                </Fragment>
            ))}
        </TextContent>
    );

};

CVETableExpandedCell.propTypes = {
    description: PropTypes.string,
    rules: PropTypes.array,
    cve: PropTypes.string
};

export default CVETableExpandedCell;
