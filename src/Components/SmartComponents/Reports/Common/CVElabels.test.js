import CVElabels from './CVElabels';
import toJson from 'enzyme-to-json';
import { mountWithIntl } from '../../../../Helpers/MiscHelper';
import { BrowserRouter as Router } from 'react-router-dom';
import configureStore from 'redux-mock-store';
import { Provider, useSelector } from 'react-redux';
import { intl } from '../../../../Utilities/IntlProvider';

const mockStore = configureStore([store => next => action => {}]);
let store = mockStore({ });

describe('CVElabels component', () => {
    it('Should match snapshot with no labels.', () => {
        const wrapper = mountWithIntl(
            <Provider store={store}>
                <Router>
                  <CVElabels intl={intl} />
                </Router>
            </Provider>
          );        
          
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('Should match snapshot with exploit and security rule label.', () => {
      const wrapper = mountWithIntl(
          <Provider store={store}>
              <Router>
                <CVElabels intl={intl} hasRule hasExploit />
              </Router>
          </Provider>
        );        
        
      expect(toJson(wrapper)).toMatchSnapshot();
  });
});
