import {
    Card,
    CardBody,
    Grid,
    GridItem,
    List,
    ListItem,
    Split,
    SplitItem,
    Stack,
    StackItem,
    Text,
    TextContent,
    TextVariants,
    Title
} from '@patternfly/react-core';
import propTypes from 'prop-types';
import React from 'react';
import { parseCvssScore } from '@red-hat-insights/insights-frontend-components/Utilities/helpers';
import ImpactBadge from '../ImpactBadge/ImpactBadge';
import SeverityRating from '../SeverityRating/SeverityRating';
import WithLoader from '../WithLoader/WithLoader';
import './CVEPageDetails.scss';

const CVEPageDetails = props => {
    return (
        <Card className="cve-overview-card">
            <CardBody>
                <Stack gutter="md">
                    <StackItem>
                        <WithLoader loading={props.data.isLoading}>
                            <TextContent>
                                <Title size="3xl" className="cve-title">{props.data.data.synopsis}</Title>
                            </TextContent>
                            <TextContent>
                                <Title size="md">Publish Date: {props.data.data.public_date}</Title>
                            </TextContent>
                        </WithLoader>
                    </StackItem>
                    <StackItem>
                        <Grid>
                            <GridItem span={8}>
                                <WithLoader loading={props.data.isLoading}>
                                    <Stack gutter="md">
                                        <StackItem>
                                            <TextContent>
                                                <Text component={TextVariants.p}>{props.data.data.description}</Text>
                                            </TextContent>
                                        </StackItem>
                                        <StackItem>
                                            <List>
                                                <ListItem>{props.data.data.rh_link}</ListItem>
                                                <ListItem>{props.data.data.mitre_link}</ListItem>
                                            </List>
                                        </StackItem>
                                    </Stack>
                                </WithLoader>
                            </GridItem>
                            <GridItem span={1}>{}</GridItem>
                            <GridItem span={3}>
                                <WithLoader loading={props.data.isLoading}>
                                    <Stack gutter="md">
                                        <StackItem>
                                            <TextContent className="cve-cvss-base-score">
                                                <Title size="3xl" className="cve-cvss-base-score-value">
                                                    {parseCvssScore(props.data.data.cvss2_score, props.data.data.cvss3_score)}
                                                </Title>
                                                <Title size="md">CVSS Base Score</Title>
                                            </TextContent>
                                        </StackItem>
                                        <StackItem>
                                            <TextContent>
                                                <Title size="md" className="cve-severity-title">Severity</Title>
                                            </TextContent>
                                            <Split gutter="md">
                                                <SplitItem>
                                                    <ImpactBadge impact={props.data.data.impact} hastooltip={false} />
                                                </SplitItem>
                                                <SplitItem>
                                                    <Title size="md">
                                                        <SeverityRating impact={props.data.data.impact} format={'title'} />
                                                    </Title>
                                                </SplitItem>
                                            </Split>
                                        </StackItem>
                                        <StackItem>
                                            <TextContent>
                                                <SeverityRating impact={props.data.data.impact} format={'text'} />
                                            </TextContent>
                                        </StackItem>
                                    </Stack>
                                </WithLoader>
                            </GridItem>
                        </Grid>
                    </StackItem>
                </Stack>
            </CardBody>
        </Card>
    );
};

CVEPageDetails.propTypes = {
    data: propTypes.object
};

export default CVEPageDetails;
