import { ConditionalFilter } from '@redhat-cloud-services/frontend-components';
import debounce from 'lodash/debounce';
import propTypes from 'prop-types';
import React, { useState, useEffect }  from 'react';

const SearchFilter = props => {
    const { placeholder, value, apply } = props;
    const [filterValue, updateFilterValue] = useState(value);

    const [applyFunction] = useState(() => debounce(filter => apply({ filter, page: 1 }), 400));

    useEffect(() => applyFunction(filterValue), [filterValue]);
    useEffect(() => updateFilterValue(value), [value]);

    return (
        <ConditionalFilter
            placeholder={placeholder}
            onChange={(event, value) => updateFilterValue(value)}
            value={filterValue}
        />
    );
};

SearchFilter.propTypes = {
    placeholder: propTypes.string,
    value: propTypes.string,
    apply: propTypes.func
};

export default SearchFilter;
