import { mount } from 'enzyme';
import CVEPageDescriptionResolution from '../CVEPageDescriptionResolution/CVEPageDescriptionResolution';

describe('CVEPageDescriptionResolution, part of CVE PAGE', () => {
    let data = {
        data: {
            attributes: {
                redhat_url: 'https://access.redhat.com/security/cve/cve-2016-0800',
                secondary_url: 'http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10722',
                synopsis: 'CVE-2016-0800',
                impact: 'Important',
                public_date: '2016-03-01T00:00:00+00:00',
                modified_date: '2018-12-18T08:45:47+00:00',
                cwe_list: ['CWE-200', 'CWE-310'],
                cvss3_score: '5.900',
                cvss3_metrics: 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N',
                description: 'A padding oracle flaw was found in the Secure Sockets Layer to as DROWN.',
                package_list: [
                    'openssl098e-0.9.8e-20.el6_7.1.x86_64',
                    'openssl098e-0.9.8e-20.el6_7.1.i686',
                    'openssl-debuginfo-0.9.8e-39.el5_11.x86_64',
                    'openssl-debuginfo-0.9.8e-39.el5_11.i686',
                    'openssl-debuginfo-0.9.8e-39.el5_11.i386',
                    'openssl098e-0.9.8e-29.el7_2.3.i686',
                    'openssl-devel-1:1.0.1e-51.el7_2.4.x86_64',
                    'openssl-1:1.0.1e-51.el7_2.4.x86_64',
                    'openssl-libs-1:1.0.1e-51.el7_2.4.i686',
                    'openssl-devel-1:1.0.1e-51.el7_2.4.i686',
                    'openssl-libs-1:1.0.1e-51.el7_2.4.x86_64'
                ],
                errata_list: ['RHSA-2016:0302', 'RHSA-2016:0301', 'RHSA-2016:0372']
            },
            id: 'CVE-2016-0800',
            type: 'cve'
        },
        meta: {},
        isLoading: true
    };
    it('Display loaders', () => {
        const component = mount(<CVEPageDescriptionResolution cve={data} />);
        const loaders = component.find('svg');
        expect(loaders.length).toBeGreaterThan(2);
    });
});
