import React from 'react';
import { shallow } from 'enzyme';
import toJson from 'enzyme-to-json';
import CVEPageDetailsDescription from './CVEPageDetailsDescription';

describe('CVEPageDetailsDescription component', () => {
    it('should render without props', () => {
        const wrapper = shallow(<CVEPageDetailsDescription />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render with description but no links', () => {
        const wrapper = shallow(
            <CVEPageDetailsDescription
                description={
                    'It was found that ghostscript could leak sensitive operators on the operand stack when a pseudo-operator'
                    + ' pushes a subroutine. A specially crafted PostScript file could use this flaw to escape the -dSAFER'
                    + ' protection in order to, for example, have access to the file system and execute commands.'
                }
            />
        );
        expect(toJson(wrapper)).toMatchSnapshot();
    });
});
