import React, { Fragment } from 'react';
import { Text, TextContent, TextVariants } from '@patternfly/react-core';
import PropType from 'prop-types';
import { FormattedMessage } from 'react-intl';
import { InsightsReportCard } from '@redhat-cloud-services/frontend-components-inventory-insights';
import { CSAwIcon } from '../../PresentationalComponents/CSAwIcon/CSAwIcon';
import messages from '../../../Messages';

export const InsightsSystemRule = ({ rule, cve }) => {
    return (
        <Fragment>
            { !rule ? <InsightsNoSystemRule cve={cve}/> :
                <Fragment>
                    <TextContent className="icon-with-label">
                        <Text component={TextVariants.h3}>
                            <CSAwIcon/> {rule.rule.description || rule.rule.rule_id}
                        </Text>
                    </TextContent>

                    <InsightsReportCard report={rule} />
                </Fragment>
            }
        </Fragment>

    );
};

InsightsSystemRule.propTypes = {
    rule: PropType.shape({
        rule: PropType.object,
        details: PropType.object,
        resulotion: PropType.object
    }).isRequired,
    cve: PropType.string
};

export const InsightsNoSystemRule = ({ cve }) => {
    return (
        <TextContent className="icon-with-label">
            <Text component={TextVariants.p}>
                <FormattedMessage {...messages.exposedSystemNoRules} values={{ cve }} />
            </Text>
            <Text component={TextVariants.p}>
                <FormattedMessage {...messages.exposedSystemNoRulesInfo}/> <CSAwIcon/>
                <br/>
                <a target="_blank" rel="noopener noreferrer" href="https://access.redhat.com/articles/2968471">
                    <FormattedMessage {...messages.exposedSystemNoRulesInfoLink} />
                </a>
            </Text>
        </TextContent>
    );
};

InsightsNoSystemRule.propTypes = {
    cve: PropType.string
};
