import React from 'react';
import PropTypes from 'prop-types';
import { FormattedMessage } from 'react-intl';
import { Text, TextContent, TextVariants, Tooltip } from '@patternfly/react-core';
import Label from '../Snippets/Label';
import { CSAwIcon } from '../CSAwIcon/CSAwIcon';
import CSAwRuleSummary from '../CSAwRuleBox/CSAwRuleSummary';
import messages from '../../../Messages';

const CVETableExpandedCell = ({ description, rules, cve }) => {
    const ruleIconTooltip = <FormattedMessage {...messages.rulesIconTooltip} />;

    return (
        <TextContent className="expanded-cell">
            <Label>{<FormattedMessage {...messages.description} />}</Label>
            <Text component={TextVariants.p}>{description}</Text>

            {rules && rules.map((rule, i) => (
                rule && (
                    <div key={i} className="rule">
                        <Text component={TextVariants.p}>
                            <Label className={'icon-with-label'}>
                                <Tooltip content={ruleIconTooltip}>
                                    <CSAwIcon />
                                </Tooltip>
                                <span className="rule-name">{rule.description || rule.rule_id}</span>
                            </Label>
                        </Text>
                        <CSAwRuleSummary
                            text={rule.summary}
                            link={cve}
                            truncate={false}
                        />
                    </div>
                )
            ))}
        </TextContent>
    );

};

CVETableExpandedCell.propTypes = {
    description: PropTypes.string,
    rules: PropTypes.array,
    cve: PropTypes.string
};

export default CVETableExpandedCell;
