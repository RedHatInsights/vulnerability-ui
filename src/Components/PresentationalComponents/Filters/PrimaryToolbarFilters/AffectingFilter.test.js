import affectingFilter from './AffectingFilter'

const OPTION_ONE_OR_MORE = "true";
const OPTION_NONE = "false";

describe('affectingFilter', () => {
    const applyMock = jest.fn();

    it('Should use default currentValue (undefined) if none provided', () => {
        let filterComponent = affectingFilter(applyMock)

        expect(filterComponent.filterValues.value).toEqual(undefined)
    });

    it('Should use provided currentValue initially', () => {
        let currentFilter = { affecting: 'true' }
        let filterComponent = affectingFilter(applyMock, currentFilter)

        expect(filterComponent.filterValues.value).toStrictEqual([OPTION_ONE_OR_MORE])
    });

    it('Should call apply with correct params', () => {
        let filterComponent = affectingFilter(applyMock)

        filterComponent.filterValues.onChange('event', [])
        expect(applyMock).toBeCalledWith({ affecting: undefined, page: 1  })

        filterComponent.filterValues.onChange('event', [OPTION_ONE_OR_MORE])
        expect(applyMock).toBeCalledWith({ affecting: 'true', page: 1 })

        filterComponent.filterValues.onChange('event', [OPTION_NONE])
        expect(applyMock).toBeCalledWith({ affecting: 'false', page: 1 })

        filterComponent.filterValues.onChange('event', [OPTION_ONE_OR_MORE, OPTION_NONE])
        expect(applyMock).toBeCalledWith({ affecting: 'true,false', page: 1 })
    })
})
