import SelectCustomSorter from './SelectCustomSorter';
import { fireEvent, render, screen } from '@testing-library/react';
import '@testing-library/jest-dom';

const selectProps = null
const options = [
    { value: "op1", label: "option 1" },
    { value: "op2", label: "option 2" },
    { value: "op3", label: "option 3" }
]

describe('SelectCustomSorter component', () => {
    it('Should have selected second item by default.', () => {
        let sorterData = "op2"
        const setSorterData = newData => sorterData = newData

        render(
            <SelectCustomSorter sorterData={sorterData} setSorterData={setSorterData} selectProps={selectProps} options={options} />
        );

        expect(screen.getByText('option 2')).toBeVisible(); // should be selected sorter by default
        expect(screen.queryAllByText('option 1')).toHaveLength(0); // shouldn't be visible until menu is opened
        fireEvent.click(screen.getByLabelText('Options menu'));

        expect(screen.getByRole('option', { name: 'option 1' })).toBeVisible();
        expect(screen.getByRole('option', { name: 'option 2' })).toBeVisible();
        expect(screen.getByRole('option', { name: 'option 3' })).toBeVisible();
    });
});
