import { configure, mount, render, shallow } from 'enzyme';
import Adapter from '@wojtekmaj/enzyme-adapter-react-17';
import React from 'react';
import 'babel-polyfill';
import fetch from 'unfetch';
import { PERMISSIONS } from '../src/Helpers/constants';

configure({ adapter: new Adapter() });

global.shallow = shallow;
global.render = render;
global.mount = mount;
global.React = React;
global.fetch = fetch;

global.window.__scalprum__ = {
    scalprumOptions: {
        cacheTimeout: 999999
    },
    appsConfig: {
        inventory: {
            manifestLocation: 'https://console.stage.redhat.com/apps/inventory/fed-mods.json?ts=1643875037626',
            module: 'inventory#./RootApp',
            name: 'inventory'
        },
        remediations: {
            manifestLocation: 'https://console.stage.redhat.com/apps/remediations/fed-mods.json?ts=1643875037626',
            module: 'remediations#./RemediationButton',
            name: 'remediations'
        }
    },
    factories: {
        inventory: {
            expiration: new Date('01-01-3000'),
            modules: {
                './InventoryTable': {
                    __esModule: true,
                    default: () => <div><h1>Inventory mock</h1></div>
                }
            }
        },
        remediations: {
            expiration: new Date('01-01-3000'),
            modules: {
                './RemediationButton': {
                    __esModule: true,
                    default: () => <div><h1>Remediations mock</h1></div>
                }
            }
        }
    }
};

global.window.insights = {
    chrome: {
        auth: {
            getUser: () => ({})
        },
        getUserPermissions: () => Promise.resolve(
            Object.values(PERMISSIONS).map(item => ({ permission: item }))
        )
    }
};
