import React from 'react';
import { Card, Grid, GridItem, Split, SplitItem, StackItem, Stack, Alert, CardBody, Text } from '@patternfly/react-core';
import { SecurityIcon } from '@patternfly/react-icons';
import { CVES_ALLOWED_PARAMS } from '../../../Helpers/constants';
import { constructFilterParameters, useUrlParams } from '../../../Helpers/MiscHelper';
import { useDispatch } from 'react-redux';
import { changeCveListParameters } from '../../../Store/Actions/Actions';
import { FormattedMessage } from 'react-intl';
import messages from '../../../Messages';

const Dashbar = () => {
    const dispatch = useDispatch();
    const [urlParameters, setUrlParams] = useUrlParams([CVES_ALLOWED_PARAMS]);

    const apply = (filterParams = {}) => {
        setUrlParams(filterParams);
        const params = constructFilterParameters(filterParams);
        dispatch(changeCveListParameters(params));
    };

    return (
        <Stack hasGutter>
            <StackItem>
                <Grid hasGutter>
                    <GridItem span={3}>
                        <Card className="card-box">
                            <CardBody>
                                <Text>
                                    <span className="pf-u-font-size-2xl pf-u-font-weight-bold">
                                        5
                                    </span>
                                    <span className="pf-u-font-size-md pf-u-font-weight-light pf-u-ml-sm">
                                        <FormattedMessage {...messages.dashbarKnownExploitsTitle} />
                                    </span>
                                </Text>
                                <Text>
                                    <a onClick={() => apply({ ...urlParameters, known_exploit: 'true' })}>
                                        <FormattedMessage {...messages.dashbarKnownExploitsFilterText} />
                                    </a>
                                </Text>
                            </CardBody>
                        </Card>
                    </GridItem>
                    <GridItem span={3}>
                        <Card>
                            <CardBody>
                                <Text>
                                    <span className="pf-u-font-size-2xl pf-u-font-weight-bold">
                                        2
                                    </span>
                                    <span className="pf-u-font-size-md pf-u-font-weight-light pf-u-ml-sm">
                                        <FormattedMessage {...messages.dashbarSecurityRulesTitle} />
                                    </span>
                                </Text>
                                <Text>
                                    <a onClick={() => apply({ ...urlParameters, rule_presence: 'true' })}>
                                        <FormattedMessage {...messages.dashbarSecurityRulesFilterText} />
                                    </a>
                                </Text>
                            </CardBody>
                        </Card>
                    </GridItem>
                    <GridItem span={6}>
                        <Card>
                            <CardBody>
                                <Split>
                                    <SplitItem isFilled>
                                        <Text>
                                            <SecurityIcon
                                                color="var(--pf-global--danger-color--200)"
                                                size="sm"
                                                noVerticalAlign
                                            />
                                            <span className="pf-u-ml-sm pf-u-font-size-2xl pf-u-font-weight-bold">
                                                2
                                            </span>
                                            <span className="pf-u-font-size-md pf-u-font-weight-light pf-u-ml-sm">
                                                <FormattedMessage {...messages.dashbarCriticalVulnerabilitiesTitle} />
                                            </span>
                                        </Text>
                                        <Text>
                                            <a onClick={() => apply({ ...urlParameters, impact: '7' })}>
                                                <FormattedMessage {...messages.dashbarCriticalVulnerabilitiesFilterText} />
                                            </a>
                                        </Text>
                                    </SplitItem>
                                    <SplitItem isFilled>
                                        <Text>
                                            <SecurityIcon
                                                color="var(--pf-global--warning-color--100)"
                                                size="sm"
                                                noVerticalAlign
                                            />
                                            <span className="pf-u-ml-sm pf-u-font-size-2xl pf-u-font-weight-bold">
                                                3
                                            </span>
                                            <span className="pf-u-font-size-md pf-u-font-weight-light pf-u-ml-sm">
                                                <FormattedMessage {...messages.dashbarImportantVulnerabilitiesTitle} />
                                            </span>
                                        </Text>
                                        <Text>
                                            <a onClick={() => apply({ ...urlParameters, impact: '5' })}>
                                                <FormattedMessage {...messages.dashbarImportantVulnerabilitiesFilterText} />
                                            </a>
                                        </Text>
                                    </SplitItem>
                                </Split>
                            </CardBody>
                        </Card>
                    </GridItem>
                </Grid>
            </StackItem>
            <StackItem>
                <Alert
                    variant="warning"
                    isInline
                    title="This is an announcement"
                >
                   Lorem ipsum
                </Alert>
            </StackItem>
        </Stack>
    );
};

export default Dashbar;
