
import { conditionalFilterType } from '@redhat-cloud-services/frontend-components';
import { CVSSOptions } from '../../../../Helpers/constants';
import { intl } from '../../../../Utilities/IntlProvider';
import messages from '../../../../Messages';

const cvssBaseScoreFilter = (apply, currentFilter = {}) => {
    let { cvss_filter: currentValue } = currentFilter;

    // Empty string value is not supported by PF Radio at the moment
    if (currentValue === '' || !currentValue) {
        currentValue = '0';
    }

    const filterByCvssScore = value => {
        apply({ cvss_filter: (value !== '0' && value) || '', page: 1 });
    };

    return {
        label: intl.formatMessage(messages.cvssBaseScore),
        type: conditionalFilterType.radio,
        urlParam: 'cvss_filter',
        filterValues: {
            onChange: (event, value) => {
                filterByCvssScore(value);
            },
            items: CVSSOptions.map(item => ({ label: item.label, value: item.value })),
            value: currentValue
        }
    };
};

export default cvssBaseScoreFilter;
