import toJson from 'enzyme-to-json';
import React from 'react';
import CVEDetailsPageDescription from './CVEDetailsPageDescription';
import { mountWithIntl } from '../../../Helpers/MiscHelper';

describe('CVEDetailsPageDescription component', () => {
    const cveAttributes = {
        business_risk: "Not defined",
        business_risk_id: 0,
        business_risk_justification: null,
        cvss3_metrics: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
        cvss3_score: "5.900",
        public_date: "12 May 2020",
        impact: "Important",
        status: "Resolved via mitigation",
        status_id: 6,
        synopsis: "CVE-2020-10711",
        description:
            'It was found that ghostscript could leak sensitive operators on the operand stack when a pseudo-operator' +
            ' pushes a subroutine. A specially crafted PostScript file could use this flaw to escape the -dSAFER' +
            ' protection in order to, for example, have access to the file system and execute commands.',
        systems_status_detail: { 0: 2 }
    };
    it('should render without props', () => {
        const wrapper = mountWithIntl(<CVEDetailsPageDescription cveAttributes={cveAttributes} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });
});
