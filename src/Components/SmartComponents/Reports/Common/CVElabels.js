import React from 'react';
import propTypes from 'prop-types';
import { View } from '@react-pdf/renderer';
import { InsightsLabel } from '@redhat-cloud-services/frontend-components-pdf-generator';

import styles from './styles';
import messages from '../../../../Messages';

const CVElabels = ({ intl, hasRule, hasExploit, isSmall = false }) => (
    <View style={styles.labelsWrapper}>
        {hasExploit &&
            <View style={{ ...styles.label, width: isSmall ? 62 : 70 }}>
                <InsightsLabel
                    icon={false}
                    width={isSmall ? 62 : 75}
                    variant={4}
                    label={intl.formatMessage(messages.knownExploit)}
                    textStyle={isSmall ? { ...styles.smallText, left: -56 } : undefined}
                    labelStyle={{
                        border: 'solid',
                        borderWidth: 1,
                        borderColor: '#c9190b',
                        height: isSmall ? 12 : 20
                    }}
                />
            </View>
        }
        {hasRule &&
            <View style={styles.label}>
                <InsightsLabel
                    icon={false}
                    width={isSmall ? 59 : 63}
                    label={intl.formatMessage(messages.securityRuleLabel)}
                    textStyle={isSmall ? styles.smallText : undefined}
                    labelStyle={{
                        border: 'solid',
                        borderWidth: 1,
                        borderColor: '#bee1f4',
                        height: isSmall ? 12 : 20
                    }}
                />
            </View>
        }
    </View>
);

CVElabels.propTypes = {
    hasRule: propTypes.bool,
    hasExploit: propTypes.bool,
    intl: propTypes.any,
    isSmall: propTypes.bool
};

export default CVElabels;
