import CVETableExpandedCell from './CVETableExpandedCell'
import { mountWithIntl } from '../../../Helpers/MiscHelper';

describe('CVETableExpandedCell', () => {
    it('Should render description without rules', () => {
        const wrapper = mountWithIntl(<CVETableExpandedCell description={"CVE description"} />);
        expect(wrapper.find('p').text()).toBe('CVE description')
        expect(wrapper.find('CSAwIcon')).toHaveLength(0)
    })

    it('Should render rules', () => {
        const cve = 'CVE-1234-1234'
        const rules = [{
            rule_id: 'rule_id',
            description: 'rule desription',
            summary: 'summary',
        }]
        const wrapper = mountWithIntl(<CVETableExpandedCell description={"CVE description"} rules={rules} cve={cve} />);
        expect(wrapper.find('CSAwIcon')).toHaveLength(1)
    })
});
