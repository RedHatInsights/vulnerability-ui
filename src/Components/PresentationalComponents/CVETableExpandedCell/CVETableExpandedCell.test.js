import CVETableExpandedCell from './CVETableExpandedCell'
import { render, screen } from '@testing-library/react';
import { IntlProvider } from '@redhat-cloud-services/frontend-components-translations';

describe('CVETableExpandedCell', () => {
    it('Should render description without rules', () => {
        render(
            <IntlProvider locale="en">
                <CVETableExpandedCell description="CVE description" />
            </IntlProvider>
        );

        expect(screen.getAllByTestId('expanded-cell-description')).toHaveLength(1);
        expect(screen.queryAllByTestId('rule-content')).toHaveLength(0);
    })

    it('Should render rules', () => {
        const cve = 'CVE-1234-1234'
        const rules = [{
            rule_id: 'rule_id',
            description: 'rule desription',
            summary: 'summary'
        }]
        render(
            <IntlProvider locale="en">
                <CVETableExpandedCell description="CVE description" rules={rules} cve={cve} />
            </IntlProvider>
        );

        expect(screen.getAllByTestId('rule-content')).toHaveLength(1);
    })
});
