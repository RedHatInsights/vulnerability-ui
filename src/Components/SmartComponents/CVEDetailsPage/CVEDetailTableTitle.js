import React, { useContext } from 'react';
import { Skeleton, Text, TextContent, TextVariants } from '@patternfly/react-core';
import useFeatureFlag from '../../../Utilities/useFeatureFlag';
import { AccountStatContext } from '../../../Utilities/VulnerabilityRoutes';
import { CVEPageContext } from './CVEDetailsPage';

const CVEDetailTableTitle = () => {
    const isEdgeParityEnabled = useFeatureFlag('vulnerability.edge_parity');
    const { hasEdgeDevices } = useContext(AccountStatContext);
    const { conventionalCount, edgeCount, areCountsLoading } = useContext(CVEPageContext);

    const totalCount = conventionalCount + edgeCount;

    return areCountsLoading
        ?
        <Skeleton width="25%" screenreaderText="Loading contents" aria-label="Table title skeleton" />
        : (<TextContent aria-label="Affected systems table title">
            <Text component={TextVariants.h2} id="systems-exposed-table-header">
                {hasEdgeDevices && isEdgeParityEnabled
                    ? `${totalCount} Total ${totalCount > 1 ? 'systems' : 'system' } affected`
                    : 'Systems'
                }
            </Text>
        </TextContent>);
};

export default CVEDetailTableTitle;
