import { Grid, GridItem } from '@patternfly/react-core';
import propTypes from 'prop-types';
import React from 'react';
import { CVEPageContext } from '../../SmartComponents/CVEDetailsPage/CVEDetailsPage';
import CVEPageDetailsDescription from '../CVEPageDetailsDescription/CVEPageDetailsDescription';
import CVEPageDetailsSeverity from '../CVEPageDetailsSeverity/CVEPageDetailsSeverity';
import WithLoader from '../WithLoader/WithLoader';
import CSAwRuleBox from '../CSAwRuleBox/CSAwRuleBox';

const CVEPageDetails = ({ data, changeExposedSystemsParameters }) => {
    return (
        <CVEPageContext.Consumer>
            {context => (
                <Grid hasGutter>
                    <GridItem md={8} sm={12}>
                        <WithLoader loading={context.isLoading} variant="spinner">
                            <CVEPageDetailsDescription cveAttributes={data.data} />
                        </WithLoader>
                    </GridItem>

                    <GridItem md={4} sm={12} className="severity-info-box pf-u-mt-md">
                        <CVEPageDetailsSeverity
                            impact={data.data.impact}
                            cvss2_score={data.data.cvss2_score}
                            cvss3_score={data.data.cvss3_score}
                            cvss2_metrics={data.data.cvss2_metrics}
                            cvss3_metrics={data.data.cvss3_metrics}
                        />
                    </GridItem>
                    <CSAwRuleBox
                        changeExposedSystemsParameters = {changeExposedSystemsParameters}
                        synopsis={data.data.synopsis}
                        rules={data.data.rules}
                    />
                </Grid>

            )}
        </CVEPageContext.Consumer>
    );
};

CVEPageDetails.propTypes = {
    data: propTypes.object,
    changeExposedSystemsParameters: propTypes.func
};

export default CVEPageDetails;
