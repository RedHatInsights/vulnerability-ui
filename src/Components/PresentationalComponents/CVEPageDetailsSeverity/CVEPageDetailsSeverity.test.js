import toJson from 'enzyme-to-json';
import React from 'react';
import CVEPageDetailsSeverity from './CVEPageDetailsSeverity';
import { mountWithIntl } from '../../../Helpers/MiscHelper';

describe('CVEPageDetailsSeverity component', () => {
    it('should render without props', () => {
        const wrapper = mountWithIntl(<CVEPageDetailsSeverity />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render where impact value is undefined', () => {
        const wrapper = mountWithIntl(<CVEPageDetailsSeverity impact={undefined} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render where impact value is Critical', () => {
        const wrapper = mountWithIntl(<CVEPageDetailsSeverity impact={'Critical'} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render with desctiption title Important', () => {
        const wrapper = mountWithIntl(<CVEPageDetailsSeverity impact={'Important'} />);
        expect(wrapper.find('CVEInfoBox').first().prop('descriptionTitle')).toBe('Important severity')
    });
});
