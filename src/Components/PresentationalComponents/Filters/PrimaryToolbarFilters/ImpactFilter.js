
import React from 'react';
import { conditionalFilterType } from '@redhat-cloud-services/frontend-components/ConditionalFilter';
import { IMPACT_OPTIONS } from '../../../../Helpers/constants';
import { intl } from '../../../../Utilities/IntlProvider';
import messages from '../../../../Messages';
import { SecurityIcon } from '@patternfly/react-icons';
import { Icon } from '@patternfly/react-core';

const impactFilter = (apply, currentFilter = {}) => {
    let { impact: currentValue } = currentFilter;

    const filterByImpact = values => {
        apply({ impact: (values.length > '0' && values.filter(value => value !== ',').join(',')) || '', page: 1 });
    };

    return {
        label: intl.formatMessage(messages.filterSeverity),
        type: conditionalFilterType.checkbox,
        urlParam: 'impact',
        key: 'impact',
        filterValues: {
            onChange: (event, value) => {
                filterByImpact(value);
            },
            items: IMPACT_OPTIONS.map(item => ({
                label: (
                    <React.Fragment>
                        { item.hasIcon &&
                            <Icon>
                                <SecurityIcon
                                    color={item.iconColor} className="pf-v5-u-mr-xs"
                                />
                            </Icon>
                        }
                        {item.label}
                    </React.Fragment>
                ),
                value: item.value
            })),
            value: (currentValue ? currentValue.split(',') : [])
        }
    };
};

export default impactFilter;
