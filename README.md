[![Build Status](https://travis-ci.com/RedHatInsights/vulnerability-ui.svg?branch=master)](https://travis-ci.com/RedHatInsights/vulnerability-ui)
[![semantic-release](https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg)](https://github.com/semantic-release/semantic-release)
[![GitHub release](https://img.shields.io/github/release/RedHatInsights/vulnerability-ui.svg)](https://github.com/RedHatInsights/vulnerability-ui/releases/latest)
[![codecov](https://codecov.io/gh/RedHatInsights/vulnerability-ui/branch/master/graph/badge.svg)](https://codecov.io/gh/RedHatInsights/vulnerability-ui)


# Vulnerability UI

## Getting Started

Make sure you have installed the following before starting
1. node, npm
2. docker
3. python2

There is a [comprehensive quick start guide in the Storybook Documentation](https://github.com/RedHatInsights/insights-frontend-storybook/blob/master/src/docs/welcome/quickStart/DOC.md) to setting up an Insights environment complete with:
- This repository
- [Insights Chroming](https://github.com/RedHatInsights/insights-chrome)
- [Insights Proxy](https://github.com/RedHatInsights/insights-proxy)

Use https://github.com/RedHatInsights/insights-proxy/blob/master/scripts/patch-etc-hosts.sh to patch your /etc/hosts (run only once)

## Running locally
Have [insights-proxy](https://github.com/RedHatInsights/insights-proxy) installed under PROXY_PATH and run the following


1. ` SPANDX_CONFIG="$(pwd)/vulnerability-ui/profiles/local-frontend.js" bash $PROXY_PATH scripts/run.sh
`

1. ```npm install```

2. ```npm run start```
    - starts webpack bundler and serves the files with webpack dev server

### Testing
[Jest](https://jestjs.io/) is used as the testing framework
1. ```npm run test```
    - will run tests
1. ```npm run lint```
        - will run linters 
1. ```npm run test:update```
    - will update snapshots
2. ```npm run test:watch```
    - will run watch mode

### Internationalization

#### Adding translation
if you want to add new translation, you need to modify the [Messages.js](https://github.com/RedHatInsights/vulnerability-ui/blob/master/src/Messages.js) file. 

#### Generate translation keys
Each time you add a new translation keys you need to run the following:

1.  `npm run translations`

it will automatically generate the `json` files based on the keys in the  [Messages.js](https://github.com/RedHatInsights/vulnerability-ui/blob/master/src/Messages.js). 


#### Using translation
There are two ways to use internationalization. Both ways take as an argument or prop the ID for the locale. 

1. with `intl.formatMessage(ID)`
    - [example](https://github.com/RedHatInsights/vulnerability-ui/blob/master/src/Helpers/constants.js#L21) 
2. with `<FormattedMessage ...props/>`
    - [example](https://github.com/RedHatInsights/vulnerability-ui/blob/b6f098180fff7ebbd62d4f58c61da2261fcbd192/src/Components/SmartComponents/InsightsSystemRule/InsightsSystemRule.js#L18)


## Deploying

Any push to the following branches, it will deploy to [vulnerability-ui-build](https://github.com/RedHatInsights/vulnerability-ui-build)

| Push to branch  | Updated branch(es) | Environment(s)
| -------------   |:-------------:     | :-------------:| 
| master          | ci-beta, qa-beta   | ci/qa beta
| ci-stable       | ci-stable          | ci stable
| qa-beta         | qa-beta            | qa/stage beta
| qa-stable       | qa-stable          | qa/stage stable
| prod-beta       | prod-beta          | production beta
| prod-stable     | prod-stable        | production stable



## Design System

 This project imports Patternfly components:
  - [Patternfly React](https://github.com/patternfly/patternfly-react)

## Insights Components

Insights Platform will deliver components and static assets through [npm](https://www.npmjs.com/package/@redhat-cloud-services/frontend-components). ESI tags are used to import the [chroming](https://github.com/RedHatInsights/insights-chrome) which takes care of the header, sidebar, and footer.

## Versioning
This project uses semantic versioning https://semver.org/. This process is automated by using [Semantic Release](https://github.com/semantic-release/semantic-release)
