
import { useCallback } from 'react';
import { useIntl } from 'react-intl';
import { buildCveReportConfig } from '../../../Helpers/ReportsHelper';
import {
    PDF_REPORT_TEMPLATES,
    getReportFilename
} from '../../../Helpers/constants';

const useDownloadCveReport = (downloadReport) => {
    const intl = useIntl();

    return useCallback(({ user, params, filters, reportData }) => {
        const processedFilters = {
            ...params,
            page: 1,
            page_size: Math.min(Number.MAX_SAFE_INTEGER, 9007199254740991),
            sort: params.sort || '-cvss_score',
            affecting: 'true',
            advanced_report: 'true'
        };

        const reportConfig = buildCveReportConfig({
            filters,
            intl,
            reportData,
            user
        });

        downloadReport(
            PDF_REPORT_TEMPLATES.vulnerabilities,
            getReportFilename('reports'),
            {
                filters: processedFilters,
                reportConfig
            }
        );
    }, []);
};

export default useDownloadCveReport;
