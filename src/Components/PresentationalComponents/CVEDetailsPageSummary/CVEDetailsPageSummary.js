import { Grid, GridItem } from '@patternfly/react-core';
import propTypes from 'prop-types';
import React from 'react';
import CVEDetailsPageDescription from '../CVEDetailsPageDescription/CVEDetailsPageDescription';
import CVEDetailsPageSidebar from '../CVEDetailsPageSidebar/CVEDetailsPageSidebar';
import CSAwRuleBox from '../CSAwRuleBox/CSAwRuleBox';
import { KnownExploitSummary } from '../KnownExploitSummary/KnownExploitSummary';
import NotVulnerableBox from '../CSAwRuleBox/NotVulnerableBox';

const CVEDetailsPageSummary = ({
    data,
    canEditStatusOrBusinessRisk,
    showStatusModal,
    showBusinessRiskModal,
    setHeaderFilters,
    headerFilters
}) => {

    return (
        <Grid hasGutter>
            <GridItem md={8} sm={12}>
                <CVEDetailsPageDescription cveAttributes={data.data} />
            </GridItem>

            <GridItem md={4} sm={12} className="pf-v5-u-mt-sm pf-v5-u-ml-sm">
                <CVEDetailsPageSidebar
                    cveAttributes={data.data}
                    canEditStatusOrBusinessRisk={canEditStatusOrBusinessRisk}
                    showStatusModal={showStatusModal}
                    showBusinessRiskModal={showBusinessRiskModal}
                />
            </GridItem>
            {
                data.data.known_exploit && <KnownExploitSummary/>
            }

            <CSAwRuleBox
                synopsis={data.data.synopsis}
                rules={data.data.rules}
                setHeaderFilters={setHeaderFilters}
                headerFilters={headerFilters}
            />
            <NotVulnerableBox
                synopsis={data.data.synopsis}
                notVulnerableSystemCount={data.data.affected_but_not_vulnerable}
                setHeaderFilters={setHeaderFilters}
                headerFilters={headerFilters}
            />
        </Grid>
    );
};

CVEDetailsPageSummary.propTypes = {
    data: propTypes.object,
    canEditStatusOrBusinessRisk: propTypes.bool,
    showStatusModal: propTypes.func,
    showBusinessRiskModal: propTypes.func,
    setHeaderFilters: propTypes.func,
    headerFilters: propTypes.object
};

export default CVEDetailsPageSummary;
