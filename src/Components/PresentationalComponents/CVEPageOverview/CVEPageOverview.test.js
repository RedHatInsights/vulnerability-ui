import React from 'react';
import { shallow } from 'enzyme';
import toJson from 'enzyme-to-json';
import { CVEPageOverview } from './CVEPageOverview';

const cve = {
    data: {
        systems_affected: 2,
        high_visibility: false,
        synopsis: 'CVE-2016-0800',
        public_date: '1970-01-01 00:00:00',
        impact: 'Important',
        description: 'A padding oracle flaw was found in the...',
        cvss2_score: '5.8',
        cvss3_score: null
    },
    meta: {},
    isLoading: false
};

const match = { params: { cve: 'CVE-2016-0800' } };

describe('CVEPageOverview', () => {
    it('should render without data', () => {
        const data = {
            data: {},
            meta: {},
            isLoading: false
        };
        const wrapper = shallow(<CVEPageOverview cve={data} match={match} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render with data', () => {
        const wrapper = shallow(<CVEPageOverview cve={cve} match={match} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });

    it('should render with enabled WithLoader', () => {
        const data = {
            data: {},
            meta: {},
            isLoading: true
        };
        const wrapper = shallow(<CVEPageOverview cve={data} match={match} />);
        expect(toJson(wrapper)).toMatchSnapshot();
    });
});
