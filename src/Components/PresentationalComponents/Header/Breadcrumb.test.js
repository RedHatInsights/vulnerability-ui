import Breadcrumb from './Breadcrumb';
import { BrowserRouter as Router } from 'react-router-dom';
import { render, screen } from '@testing-library/react';

describe('Breadcrumb component', () => {
    it('Should show skeleton when items are loading', () => {
        const items = [{
            title: 'some page',
            to: 'somewhere',
            isLoaded: false
        }];

        render(
            <Router>
                <Breadcrumb breadcrumbs={items}/>
            </Router>
        );

        expect(screen.getAllByTestId('breadcrumb-skeleton')).toHaveLength(1);
    })

    it('Should match snapshot', () => {
        const items = [{
            title: 'some page',
            to: 'somewhere',
            isLoaded: false
        },
        {
            title: 'some other page',
            to: 'somewhereElse',
            isLoaded: true
        },
        {
            title: 'current page',
            isActive: true,
            isLoaded: true
        }]

        const { asFragment } = render(
            <Router>
                <Breadcrumb breadcrumbs={items}/>
            </Router>
        );

        expect(asFragment()).toMatchSnapshot();
    })

    it('Should link to the correct pages', () => {
        const items = [{
            title: 'some page',
            to: 'somewhere',
            isLoaded: true
        },
        {
            title: 'current page',
            isActive: true,
            isLoaded: true
        }]

        render(
            <Router>
                <Breadcrumb breadcrumbs={items}/>
            </Router>
        );

        const list = screen.getAllByRole('listitem');
        expect(list).toHaveLength(2);

        const links = screen.getAllByRole('link');
        expect(links).toHaveLength(1);
    })
});
